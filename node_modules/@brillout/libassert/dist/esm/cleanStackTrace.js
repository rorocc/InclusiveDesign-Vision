export { cleanStackTrace };
function cleanStackTrace(err, numberOfStackTraceLinesToRemove) {
    err.stack = clean(err.stack, numberOfStackTraceLinesToRemove);
}
function clean(errStack, numberOfStackTraceLinesToRemove) {
    if (!errStack) {
        return errStack;
    }
    const stackLines = splitByLine(errStack);
    let linesRemoved = 0;
    const stackLine__cleaned = stackLines
        .filter((line) => {
        // Remove internal stack traces
        if (line.includes(" (internal/") || line.includes(" (node:internal")) {
            return false;
        }
        if (linesRemoved < numberOfStackTraceLinesToRemove &&
            isStackTraceLine(line)) {
            linesRemoved++;
            return false;
        }
        return true;
    })
        .join("\n");
    return stackLine__cleaned;
}
function isStackTraceLine(line) {
    return line.startsWith('    at ');
}
function splitByLine(str) {
    // https://stackoverflow.com/questions/21895233/how-in-node-to-split-string-by-newline-n
    return str.split(/\r?\n/);
}
//# sourceMappingURL=cleanStackTrace.js.map